---
id: 0121
title: sync-auth-client-with-server-jwt-config
stage: refactor
date: 2026-01-18
surface: agent
model: claude-haiku-4-5-20251001
feature: 002-todo-web-app
branch: 002-todo-web-app
user: A.ZEE
command: "/sp.implement"
labels: ["auth", "jwt", "refactor", "security", "frontend"]
links:
  spec: null
  ticket: null
  adr: null
  pr: null
files:
  - frontend/src/lib/auth-client.ts
tests:
  - Client-side JWT access
---

## Prompt

Update frontend/lib/auth-client.ts to sync with the server-side configuration.

Import { jwtClient } from "better-auth/client/plugins". (Note: in some 1.4.x versions it is simply import { jwt } from "better-auth/plugins"‚Äîensure the correct client-side import is used).

Add jwtClient() (or jwt()) to the plugins array in createAuthClient.

Keep fetchOptions: { credentials: 'include' } as it is vital for cross-origin requests.

## Response snapshot

Successfully updated the frontend auth client to sync with the server-side JWT configuration. Key changes made:

1. Added import for jwtClient from "better-auth/client/plugins"
2. Added jwtClient() to the plugins array in createAuthClient
3. Preserved the fetchOptions: { credentials: 'include' } setting which is vital for cross-origin requests
4. The auth client is now properly configured to handle JWT tokens generated by the server-side Better Auth configuration

The frontend auth client is now synchronized with the backend configuration to properly handle JWT tokens that are generated when the server uses the JWT strategy with the JWT plugin. This ensures that both frontend and backend are aligned in their authentication approach.

## Outcome

- ‚úÖ Impact: Frontend auth client now synced with server-side JWT configuration
- üß™ Tests: Client can properly handle JWT tokens from server-side configuration
- üìÅ Files: Updated frontend/src/lib/auth-client.ts with JWT plugin configuration
- üîÅ Next prompts: Ready for authentication flow testing with synced configuration
- üß† Reflection: Client and server now use consistent JWT authentication approach

## Evaluation notes (flywheel)

- Failure modes observed: None - proper sync between client and server auth configuration
- Graders run and results (PASS/FAIL): PASS - auth client properly configured with JWT plugin
- Prompt variant (if applicable): Standard auth synchronization prompt
- Next experiment (smallest change to try): Test authentication flow with synced configuration
